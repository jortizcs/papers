\chapter{Sensing in the Built Environment}
\label{chap:SensingInBuiltMain}

% Buildings consume nearly 40\% of the total energy produced in the United States and 72\% of the electricity.  Similar figures 
% have been recorded in other industrialized countries~\cite{buildings_study}.  Furthermore, studies show that they waste from
% 30-80\% of the energy they consume.  

Building management systems consist of thousands of sensors embedded in the systems that control the internal environment and
the spaces occupied by people.  Many different sensors take disparate physical measurements, continuously.
For example, temperature sensors take Fahrenheit readings in the thermostats,
valve-position sensors measure the position angle of the valve in the pipes, pressure sensors record pressure measurements in the vents, 
etc.
% temperature sensors on the vents and pipes as well, etc.
The BMS presents these through a graphical interface to the building managers.  The graphical interface contains graphical sketches
of the systems and spaces in the building with icon images of the sensors in their approximate physical location represented
in the sketch.  The image sketch is generated from building schematics, so the interface is representative at the time of construction.
Building managers can quickly locate any sensor in the building through a series of clicks.

% that is giving bad readings or find the sensors that support
% a space where complaints are coming from, so that he/she could identify faulty readings through close inspection.
% The interface also allows them to visually inspect and quickly try to diagnose a problem, typically in response to occupant
% complaints.

Although BMS's have, to some degree, been an effective tool for centralized management of buildings, they lack the extensibility
and analytical capabilities necessary to support an ecosystem of tools for analyzing the building.  In general, software
practices in the building are non-standardized and non-systematic.
% Although BMS's have been revolutionary from a building management perspective, they lack many fundamental components for
% the kind of analysis that is needed to understand the building's operation over time.
% is performing now  
% and will perform in the future.  
% Also, building practices for software-driven building systems serve more as guideline than
% as a standard.  Naming, access, and organization of building data varies as much as buildings do.
This presents major challenges with respect to software re-use and scalability.  
In this thesis we discuss how we address these challenges through architectural design choices and analytical methodology.  
The architectural choices reconstruct the software layer that sits on top of existing building management systems and presents
a unified interface and standard API for analytical and control building applications.
The analytical methodology offers a general approach for verifying the construction of point names -- the naming scheme for 
sensors distributed throughout the building.  
% Both set a foundation for ongoing and future work.

The thesis is presented in the context of BMS systems and the building applications we aim to support.
% building systems and building-related applications.  
% We draw out the components in our analysis and design and discuss where it fits in the broader context of prior, computer-science related
% literature.  
In the next section, we describe the state-of-the-art practices followed by vendors of building information systems.
We describe the architectural features and design principles both implicitly and explicitly implemented into them.
We also present the pros and cons of these decisions and their implications and include a high-level description of our approach.
% Later chapters delve more deeply into the implications of our design decisions.

\input{SensingInTheBuiltEnvironment/IntegratedBMS}
\input{SensingInTheBuiltEnvironment/SupervisoryCtrlToApps}
\input{SensingInTheBuiltEnvironment/BMSShortcomings}
\input{SensingInTheBuiltEnvironment/AddressingBMSShort}
\input{SensingInTheBuiltEnvironment/ContextAccuracy}

\section{Experimental Setting in Real Buildings}
In this thesis we describe and the architecture and implementation of a system that supports emerging applications and the ``app-ification''
of buildings.  We construct a system called StreamFS and deploy it and/or analyze data from several buildings, including
Cory Hall, Sutardja Dai Hall, and Soda Hall, and Engineering Building 2 at the University of Tokyo (Todai).
% \subsection{Cory Hall - UC Berkeley}
Cory Hall, at UC Berkeley, is a 5-story building hosting mainly classrooms, meeting rooms, laboratories and a datacenter.
% This building was completed in 1950, thus its infrastructure is significantly different from the Japanese one.
The HVAC system in the building is centralized and serves several floors per unit.
There is a separate unit for an internal fabrication laboratory, inside the building.
%Nevertheless, we notice an independent HVAC system that was serving a particular laboratory; the Microfabrication Laboratory (Microlab).
% \subsection{Sutardja Dai Hall - UC Berkeley}
Sutardja Dai Hall is a large building at Berkeley.  It is a 7-story, 141000 square-foot 
 building which contains classrooms, meeting rooms, laboratories, a nano-fabrication laboratory, and a cafe.
% This building was completed in 1950, thus its infrastructure is significantly different from the Japanese one.
The HVAC system in the building is centralized and serves several floors per unit.
There is also a separate unit for an internal fabrication laboratory, inside the building.  It was built in 2009.
% \subsection{Soda Hall - UC Berkeley}
Soda Hall is another building at Berkeley.  It is the main building for the computer science department.
It was built in 1994 and also has 7 floors and a centralized HVAC system.  It contains classrooms, 
offices, server rooms, and open office spaces for several labs.
The Todai Engineering building is 12-story building on the main campus of the University of Tokyo in Tokyo, Japan.
It was built in 2005 and contains shared office space, individual offices, lecture classrooms, and small
classrooms.

These buildings represent a wide sampling of characteristics common in an office setting within the commercial building sector.  Moreover,
this allows us to examine the generality across climates and HVAC architectures, since the Tokyo building does not use a centralized
HVAC system.  Cory Hall was built in the 1950's and has been through many changes since then.  Originally, the 5th floor did not exist
and several structural aspect of the building have been altered.  Moreover, with changes in technology and research focus, the activities
the building supports has also changed.  This is reflected in both the structure of the building and the design of the HVAC systems inside it.
In all, there are about 15 different HVAC systems within Cory Hall.  Soda Hall was built in the 1990's.  It supports mainly
small labs, shared space, and a few small datacenters -- clusters of machines in a server room.
The Tokyo building is different from the other three, in that the Tokyo experiences four distinct seasons, the HVAC system is distrubuted,
and the all the data we examine is post-Fukushima disaster \cite{fukushima}.  This events drastically altered the energy usage profile
of the building, as mandates for energy reduction were disseminated across all of Japan.

In the context of the rest of the building stock in the United States.  Soda Hall, Cory Hall, and Sutardja Dai Hall are representative
buildings within the office-building category.  Although, both Cory and Sutardja Dai support fabrication laborties that consume high-than-average
energy than most activities in a typical office building.  Moreover, all three host several machine clusters with most of the machines consuming
power continuously.  More broadly, they all fall into the ``Commerical Sector'' category according to the Department of Energy~\cite{EIA}.
Commercial buildings consume $>$ 40\% of total energy in the United States.  More specifically, these buildings also fall into the \emph{Office} category,
which consume about 19\% of total consumption for the broader ``commercial'' category.  In addition, Cory Hall and Sutardja Dai Hall are $>100,000$
square feet while Soda Hall is about $60,000$ square feet.  28\% of all buildings fall in the range from 50-200k square feet in the 
United States \cite{EIA}.
The distribution of consumption is similar in many ways to the distribution in the United States.  In Japan, buildings consume 33\% of 
total energy \cite{Japan_buildings}, which is higher than either the industrial or transportation sectors.

\begin{figure}[t!] %htbp
\centering
\includegraphics[width=1.0\columnwidth]{figs/end_use_fuel_type}
\caption{Distribution of energy consumption in buildings by end-use.  Table reproduced here from the 2011 Buildings 
Energy Data Book \cite{EIA}.}
\label{fig:end_use_energy}
\end{figure}

Figure~\ref{fig:end_use_energy} shows the distribution of energy expenditures by end-use category in buildings, presented in ~\cite{EIA} and
reproduced here.  Note, about 50-60\% is used by the HVAC system and Lighting, and about a third goes to other and plug-loads.  These figures
motivate the applications presented in this chapter.  In particular, we show how energy audits of miscellaneous loads is enabled and can be coupled
with total consumption data through the `Mobile Energy Lens' application, presented in Chapter \ref{chap:ArchEvalMain}.
For StreamFS and related applications, we set up deployments in each of these buildings to collect sensor data.  Our verification
processes runs on StreamFS as a mixture of external and internal processes, which we discuss in Chapter~\ref{chap:mechanisms}.
We describe the specific set up of the infrastructure and deployment in their respective chapters.  We give details 
about the sensors and size of the data set that are collected as well.
We also do four small deployments that we do not describe in the thesis.  They are deployments in small office spaces at 
Nokia, Intel, and Samsung as well as one in an apartment with a few appliances and meters.



\input{SensingInTheBuiltEnvironment/Summary}
